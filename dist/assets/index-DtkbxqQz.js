import{b as x,c as se,d as re,_ as Z,e as $e,f as L,h as J,j as t,s as F,B as Re,i as G,k as ce,l as ke,m as Y,n as W,o as le,p as Me,q as Ie,R as T,u as _,t as D,v as V,w as ze,x as Le,y as H,Q as U,z as ue,M as me,S as fe}from"./index-Bpu-ZP8V.js";import{A as xe}from"./index-CS8AJtqV.js";import{C as ie}from"./index-CdXBdv_H.js";import{F as be,B as O}from"./index-BwNXfVh5.js";import{c as Q,a as q,b as oe}from"./object-B-5gPB25.js";import{B as X}from"./index-B5psXmxu.js";import{U as Ce,R as je}from"./index-BZImyS4q.js";import{S as ye}from"./index-DwaAnJwn.js";import{F as ee,L as te,S as Be,D as de,a as Ne}from"./index-DOw9Vza5.js";import{S as Ee}from"./index-BAGGOChB.js";import{u as Te}from"./useStoreManagement-AgWGUTwC.js";import"./PhoneIcon-BpksOs-8.js";function Oe({title:e,titleId:a,...r},s){return x.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:s,"aria-labelledby":a},r),e?x.createElement("title",{id:a},e):null,x.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const Ae=x.forwardRef(Oe);function Ue(e){return re("MuiPagination",e)}se("MuiPagination",["root","ul","outlined","text"]);const De=["boundaryCount","componentName","count","defaultPage","disabled","hideNextButton","hidePrevButton","onChange","page","showFirstButton","showLastButton","siblingCount"];function Ve(e={}){const{boundaryCount:a=1,componentName:r="usePagination",count:s=1,defaultPage:w=1,disabled:C=!1,hideNextButton:S=!1,hidePrevButton:h=!1,onChange:j,page:v,showFirstButton:y=!1,showLastButton:R=!1,siblingCount:N=1}=e,o=Z(e,De),[c,M]=$e({controlled:v,default:w,name:r,state:"page"}),$=(l,P)=>{v||M(P),j&&j(l,P)},I=(l,P)=>{const n=P-l+1;return Array.from({length:n},(f,g)=>l+g)},k=I(1,Math.min(a,s)),u=I(Math.max(s-a+1,a+1),s),i=Math.max(Math.min(c-N,s-a-N*2-1),a+2),m=Math.min(Math.max(c+N,a+N*2+2),u.length>0?u[0]-2:s-1),b=[...y?["first"]:[],...h?[]:["previous"],...k,...i>a+2?["start-ellipsis"]:a+1<s-a?[a+1]:[],...I(i,m),...m<s-a-1?["end-ellipsis"]:s-a>a?[s-a]:[],...u,...S?[]:["next"],...R?["last"]:[]],p=l=>{switch(l){case"first":return 1;case"previous":return c-1;case"next":return c+1;case"last":return s;default:return null}},d=b.map(l=>typeof l=="number"?{onClick:P=>{$(P,l)},type:"page",page:l,selected:l===c,disabled:C,"aria-current":l===c?"true":void 0}:{onClick:P=>{$(P,p(l))},type:l,page:p(l),selected:!1,disabled:C||l.indexOf("ellipsis")===-1&&(l==="next"||l==="last"?c>=s:c<=1)});return L({items:d},o)}function Fe(e){return re("MuiPaginationItem",e)}const A=se("MuiPaginationItem",["root","page","sizeSmall","sizeLarge","text","textPrimary","textSecondary","outlined","outlinedPrimary","outlinedSecondary","rounded","ellipsis","firstLast","previousNext","focusVisible","disabled","selected","icon"]),ae=J(t.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"}),"NavigateBefore"),ne=J(t.jsx("path",{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),"NavigateNext"),Ge=["className","color","component","components","disabled","page","selected","shape","size","type","variant"],Pe=(e,a)=>{const{ownerState:r}=e;return[a.root,a[r.variant],a[`size${W(r.size)}`],r.variant==="text"&&a[`text${W(r.color)}`],r.variant==="outlined"&&a[`outlined${W(r.color)}`],r.shape==="rounded"&&a.rounded,r.type==="page"&&a.page,(r.type==="start-ellipsis"||r.type==="end-ellipsis")&&a.ellipsis,(r.type==="previous"||r.type==="next")&&a.previousNext,(r.type==="first"||r.type==="last")&&a.firstLast]},We=e=>{const{classes:a,color:r,disabled:s,selected:w,size:C,shape:S,type:h,variant:j}=e,v={root:["root",`size${W(C)}`,j,S,r!=="standard"&&`${j}${W(r)}`,s&&"disabled",w&&"selected",{page:"page",first:"firstLast",last:"firstLast","start-ellipsis":"ellipsis","end-ellipsis":"ellipsis",previous:"previousNext",next:"previousNext"}[h]],icon:["icon"]};return le(v,Fe,a)},qe=F("div",{name:"MuiPaginationItem",slot:"Root",overridesResolver:Pe})(({theme:e,ownerState:a})=>L({},e.typography.body2,{borderRadius:32/2,textAlign:"center",boxSizing:"border-box",minWidth:32,padding:"0 6px",margin:"0 3px",color:(e.vars||e).palette.text.primary,height:"auto",[`&.${A.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity}},a.size==="small"&&{minWidth:26,borderRadius:26/2,margin:"0 1px",padding:"0 4px"},a.size==="large"&&{minWidth:40,borderRadius:40/2,padding:"0 10px",fontSize:e.typography.pxToRem(15)})),_e=F(Re,{name:"MuiPaginationItem",slot:"Root",overridesResolver:Pe})(({theme:e,ownerState:a})=>L({},e.typography.body2,{borderRadius:32/2,textAlign:"center",boxSizing:"border-box",minWidth:32,height:32,padding:"0 6px",margin:"0 3px",color:(e.vars||e).palette.text.primary,[`&.${A.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${A.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity},transition:e.transitions.create(["color","background-color"],{duration:e.transitions.duration.short}),"&:hover":{backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${A.selected}`]:{backgroundColor:(e.vars||e).palette.action.selected,"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.selected} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:G(e.palette.action.selected,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:(e.vars||e).palette.action.selected}},[`&.${A.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.action.selected} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:G(e.palette.action.selected,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)},[`&.${A.disabled}`]:{opacity:1,color:(e.vars||e).palette.action.disabled,backgroundColor:(e.vars||e).palette.action.selected}}},a.size==="small"&&{minWidth:26,height:26,borderRadius:26/2,margin:"0 1px",padding:"0 4px"},a.size==="large"&&{minWidth:40,height:40,borderRadius:40/2,padding:"0 10px",fontSize:e.typography.pxToRem(15)},a.shape==="rounded"&&{borderRadius:(e.vars||e).shape.borderRadius}),({theme:e,ownerState:a})=>L({},a.variant==="text"&&{[`&.${A.selected}`]:L({},a.color!=="standard"&&{color:(e.vars||e).palette[a.color].contrastText,backgroundColor:(e.vars||e).palette[a.color].main,"&:hover":{backgroundColor:(e.vars||e).palette[a.color].dark,"@media (hover: none)":{backgroundColor:(e.vars||e).palette[a.color].main}},[`&.${A.focusVisible}`]:{backgroundColor:(e.vars||e).palette[a.color].dark}},{[`&.${A.disabled}`]:{color:(e.vars||e).palette.action.disabled}})},a.variant==="outlined"&&{border:e.vars?`1px solid rgba(${e.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${e.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${A.selected}`]:L({},a.color!=="standard"&&{color:(e.vars||e).palette[a.color].main,border:`1px solid ${e.vars?`rgba(${e.vars.palette[a.color].mainChannel} / 0.5)`:G(e.palette[a.color].main,.5)}`,backgroundColor:e.vars?`rgba(${e.vars.palette[a.color].mainChannel} / ${e.vars.palette.action.activatedOpacity})`:G(e.palette[a.color].main,e.palette.action.activatedOpacity),"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette[a.color].mainChannel} / calc(${e.vars.palette.action.activatedOpacity} + ${e.vars.palette.action.focusOpacity}))`:G(e.palette[a.color].main,e.palette.action.activatedOpacity+e.palette.action.focusOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${A.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette[a.color].mainChannel} / calc(${e.vars.palette.action.activatedOpacity} + ${e.vars.palette.action.focusOpacity}))`:G(e.palette[a.color].main,e.palette.action.activatedOpacity+e.palette.action.focusOpacity)}},{[`&.${A.disabled}`]:{borderColor:(e.vars||e).palette.action.disabledBackground,color:(e.vars||e).palette.action.disabled}})})),Xe=F("div",{name:"MuiPaginationItem",slot:"Icon",overridesResolver:(e,a)=>a.icon})(({theme:e,ownerState:a})=>L({fontSize:e.typography.pxToRem(20),margin:"0 -8px"},a.size==="small"&&{fontSize:e.typography.pxToRem(18)},a.size==="large"&&{fontSize:e.typography.pxToRem(22)})),Qe=x.forwardRef(function(a,r){const s=ce({props:a,name:"MuiPaginationItem"}),{className:w,color:C="standard",component:S,components:h={first:ee,last:te,next:ne,previous:ae},disabled:j=!1,page:v,selected:y=!1,shape:R="circular",size:N="medium",type:o="page",variant:c="text"}=s,M=Z(s,Ge),$=L({},s,{color:C,disabled:j,selected:y,shape:R,size:N,type:o,variant:c}),I=ke(),k=We($),i=(I.direction==="rtl"?{previous:h.next||ne,next:h.previous||ae,last:h.first||ee,first:h.last||te}:{previous:h.previous||ae,next:h.next||ne,first:h.first||ee,last:h.last||te})[o];return o==="start-ellipsis"||o==="end-ellipsis"?t.jsx(qe,{ref:r,ownerState:$,className:Y(k.root,w),children:"…"}):t.jsxs(_e,L({ref:r,ownerState:$,component:S,disabled:j,className:Y(k.root,w)},M,{children:[o==="page"&&v,i?t.jsx(Xe,{as:i,ownerState:$,className:k.icon}):null]}))}),He=["boundaryCount","className","color","count","defaultPage","disabled","getItemAriaLabel","hideNextButton","hidePrevButton","onChange","page","renderItem","shape","showFirstButton","showLastButton","siblingCount","size","variant"],Ye=e=>{const{classes:a,variant:r}=e;return le({root:["root",r],ul:["ul"]},Ue,a)},Ze=F("nav",{name:"MuiPagination",slot:"Root",overridesResolver:(e,a)=>{const{ownerState:r}=e;return[a.root,a[r.variant]]}})({}),Je=F("ul",{name:"MuiPagination",slot:"Ul",overridesResolver:(e,a)=>a.ul})({display:"flex",flexWrap:"wrap",alignItems:"center",padding:0,margin:0,listStyle:"none"});function Ke(e,a,r){return e==="page"?`${r?"":"Go to "}page ${a}`:`Go to ${e} page`}const et=x.forwardRef(function(a,r){const s=ce({props:a,name:"MuiPagination"}),{boundaryCount:w=1,className:C,color:S="standard",count:h=1,defaultPage:j=1,disabled:v=!1,getItemAriaLabel:y=Ke,hideNextButton:R=!1,hidePrevButton:N=!1,renderItem:o=d=>t.jsx(Qe,L({},d)),shape:c="circular",showFirstButton:M=!1,showLastButton:$=!1,siblingCount:I=1,size:k="medium",variant:u="text"}=s,i=Z(s,He),{items:m}=Ve(L({},s,{componentName:"Pagination"})),b=L({},s,{boundaryCount:w,color:S,count:h,defaultPage:j,disabled:v,getItemAriaLabel:y,hideNextButton:R,hidePrevButton:N,renderItem:o,shape:c,showFirstButton:M,showLastButton:$,siblingCount:I,size:k,variant:u}),p=Ye(b);return t.jsx(Ze,L({"aria-label":"pagination navigation",className:Y(p.root,C),ownerState:b,ref:r},i,{children:t.jsx(Je,{className:p.ul,ownerState:b,children:m.map((d,l)=>t.jsx("li",{children:o(L({},d,{color:S,"aria-label":y(d.type,d.page,d.selected),shape:c,size:k,variant:u}))},l))})}))}),tt=J(t.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"RadioButtonUnchecked"),at=J(t.jsx("path",{d:"M8.465 8.465C9.37 7.56 10.62 7 12 7C14.76 7 17 9.24 17 12C17 13.38 16.44 14.63 15.535 15.535C14.63 16.44 13.38 17 12 17C9.24 17 7 14.76 7 12C7 10.62 7.56 9.37 8.465 8.465Z"}),"RadioButtonChecked"),nt=F("span")({position:"relative",display:"flex"}),it=F(tt)({transform:"scale(1)"}),ot=F(at)(({theme:e,ownerState:a})=>L({left:0,position:"absolute",transform:"scale(0)",transition:e.transitions.create("transform",{easing:e.transitions.easing.easeIn,duration:e.transitions.duration.shortest})},a.checked&&{transform:"scale(1)",transition:e.transitions.create("transform",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.shortest})}));function we(e){const{checked:a=!1,classes:r={},fontSize:s}=e,w=L({},e,{checked:a});return t.jsxs(nt,{className:r.root,ownerState:w,children:[t.jsx(it,{fontSize:s,className:r.background,ownerState:w}),t.jsx(ot,{fontSize:s,className:r.dot,ownerState:w})]})}const st=x.createContext(void 0);function rt(){return x.useContext(st)}function ct(e){return re("MuiRadio",e)}const pe=se("MuiRadio",["root","checked","disabled","colorPrimary","colorSecondary"]),lt=["checked","checkedIcon","color","icon","name","onChange","size","className"],dt=e=>{const{classes:a,color:r}=e,s={root:["root",`color${W(r)}`]};return L({},a,le(s,ct,a))},ut=F(Be,{shouldForwardProp:e=>Me(e)||e==="classes",name:"MuiRadio",slot:"Root",overridesResolver:(e,a)=>{const{ownerState:r}=e;return[a.root,a[`color${W(r.color)}`]]}})(({theme:e,ownerState:a})=>L({color:(e.vars||e).palette.text.secondary,"&:hover":{backgroundColor:e.vars?`rgba(${a.color==="default"?e.vars.palette.action.activeChannel:e.vars.palette[a.color].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:G(a.color==="default"?e.palette.action.active:e.palette[a.color].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},a.color!=="default"&&{[`&.${pe.checked}`]:{color:(e.vars||e).palette[a.color].main}},{[`&.${pe.disabled}`]:{color:(e.vars||e).palette.action.disabled}}));function pt(e,a){return typeof a=="object"&&a!==null?e===a:String(e)===String(a)}const he=t.jsx(we,{checked:!0}),ge=t.jsx(we,{}),ht=x.forwardRef(function(a,r){var s,w;const C=ce({props:a,name:"MuiRadio"}),{checked:S,checkedIcon:h=he,color:j="primary",icon:v=ge,name:y,onChange:R,size:N="medium",className:o}=C,c=Z(C,lt),M=L({},C,{color:j,size:N}),$=dt(M),I=rt();let k=S;const u=Ie(R,I&&I.onChange);let i=y;return I&&(typeof k>"u"&&(k=pt(I.value,C.value)),typeof i>"u"&&(i=I.name)),t.jsx(ut,L({type:"radio",icon:x.cloneElement(v,{fontSize:(s=ge.props.fontSize)!=null?s:N}),checkedIcon:x.cloneElement(h,{fontSize:(w=he.props.fontSize)!=null?w:N}),ownerState:M,classes:$,name:i,checked:k,onChange:u,ref:r,className:Y($.root,o)},c))}),Se=e=>{var s,w;const a=x.useRef(),r=x.useRef();return x.useEffect(()=>{var C;a.current=window.cloudinary,r.current=(C=a.current)==null?void 0:C.createUploadWidget({cloudName:"dfnuzzpe3",uploadPreset:"ml_default"},function(S,h){var j,v,y,R;((j=h==null?void 0:h.data)==null?void 0:j.event)=="queues-end"&&e.setThumbnailUploaded((R=(y=(v=h==null?void 0:h.data)==null?void 0:v.info)==null?void 0:y.files)==null?void 0:R.map(N=>{var o;return(o=N==null?void 0:N.uploadInfo)==null?void 0:o.secure_url}))})},[r]),t.jsxs(t.Fragment,{children:[t.jsx("p",{className:"text-md mr-1 font-bold text-gray-700",children:"Upload các ảnh khác"}),t.jsx("button",{className:"rounded-lg border border-gray-300 bg-white px-4 py-2 text-left text-sm text-gray-600",onClick:()=>{var C;return(C=r.current)==null?void 0:C.open()},children:((s=e.thumbnailUploaded)==null?void 0:s.length)>0?"Các ảnh":"Đăng các ảnh khác"}),t.jsx("div",{className:"flex w-full flex-wrap gap-x-2 gap-y-1",children:((w=e.thumbnailUploaded)==null?void 0:w.length)>0&&e.thumbnailUploaded.map((C,S)=>t.jsx("img",{src:C,alt:"thumbnail",className:"h-20 w-20 rounded-lg object-cover"},S))})]})},gt=e=>{const{currentProduct:a,onClose:r,loading:s,onConfirm:w}=e,[C,S]=T.useState(a||null),[h,j]=T.useState([]),{accessToken:v}=_(u=>u.auth),[y,R]=T.useState(null),[N,o]=T.useState(""),[c,M]=T.useState([]),$=Q().shape({name:q().required("Vui lòng điền tên sản phẩm"),upc:q().required("Vui lòng nhập mã sản phẩm"),price:Q().shape({price:oe().required("Vui lòng nhập giá sản phẩm"),displayPrice:q().required("Vui lòng nhập giá sản phẩm")})}),I=async u=>{w({...u,price:{...u.price,price:Number(u.price.price)},properties:u.properties||{},thumbnail:N,images:c})},k=async()=>{var u,i;try{const m=await D.get(`${V}/category`,{headers:{Authorization:`Bearer ${v}`}});m!=null&&m.data.success&&j((i=(u=m==null?void 0:m.data)==null?void 0:u.data)==null?void 0:i.data)}catch(m){console.log("GET PRODUCT CATEGORY ERROR",m)}finally{}};return x.useEffect(()=>{k()},[]),x.useEffect(()=>{a!=null&&a.category&&(S({...a,category:a.category.id}),R(a.category),o(a.thumbnail||""),M(a.images||[]))},[a]),t.jsx(be,{initialValues:C||{},validationSchema:$,onSubmit:I,enableReinitialize:!0,children:({submitForm:u,values:i,handleSubmit:m,setValues:b,setFieldValue:p})=>{var d,l,P;return t.jsxs("div",{className:"flex flex-col space-y-10",children:[t.jsxs("div",{className:"flex flex-col space-y-5",children:[t.jsxs("div",{className:"grid grid-cols-1 items-center justify-between gap-x-2 gap-y-5 tablet:grid-cols-2",children:[t.jsx(O,{type:"text",name:"name",value:i==null?void 0:i.name,label:"Tên sản phẩm",placeholder:"Nhập tên sản phẩm"}),t.jsx(O,{type:"text",name:"upc",value:i==null?void 0:i.upc,label:"Mã sản phẩm",placeholder:"Nhập mã sản phẩm"})]}),t.jsxs("div",{className:"grid grid-cols-1 items-center justify-between gap-x-2 gap-y-5 tablet:grid-cols-2",children:[t.jsx(O,{type:"number",mode:"text",name:"price.price",value:(d=i==null?void 0:i.price)==null?void 0:d.price,label:"Giá sản phẩm",placeholder:"Nhập giá sản phẩm"}),t.jsx(O,{type:"text",name:"price.displayPrice",value:(l=i==null?void 0:i.price)==null?void 0:l.displayPrice,label:"Giá hiển thị sản phẩm",placeholder:"Nhập giá hiển thị sản phẩm"})]}),t.jsx(Ce,{thumbnailUploaded:N,setThumbnailUploaded:n=>o(n)}),t.jsx(Se,{thumbnailUploaded:c,setThumbnailUploaded:n=>M(n)}),t.jsx("div",{className:"grid grid-cols-1 items-center justify-between gap-x-2 gap-y-5 tablet:grid-cols-2",children:t.jsx(ye,{name:"category",label:"Danh mục",placeholder:"Chọn danh mục",optionSelected:y,keyValue:"id",keyLabel:"name",options:h,onSelect:n=>{R(n),p("category",n.id)}})}),t.jsx("div",{className:"grid grid-cols-1 items-center justify-between gap-x-2 gap-y-5 tablet:grid-cols-2",children:!!y&&((P=y==null?void 0:y.properties)==null?void 0:P.map((n,f)=>{var g,z,B,E;return t.jsxs(t.Fragment,{children:[(n==null?void 0:n.type)=="string"&&t.jsx(O,{type:n==null?void 0:n.type,mode:"text",name:`properties.${n==null?void 0:n.name}`,value:String((g=i==null?void 0:i.properties)==null?void 0:g[n==null?void 0:n.name])||"",label:(n==null?void 0:n.displayName)||"",placeholder:`Nhập ${(n==null?void 0:n.displayName)||""}`}),(n==null?void 0:n.type)=="number"&&t.jsx(O,{type:n==null?void 0:n.type,mode:"text",onChange:K=>{p(`properties.${n==null?void 0:n.name}`,Number(K.target.value))},name:`properties.${n==null?void 0:n.name}`,value:Number((z=i==null?void 0:i.properties)==null?void 0:z[n==null?void 0:n.name])||"",label:(n==null?void 0:n.displayName)||"",placeholder:`Nhập ${(n==null?void 0:n.displayName)||""}`}),(n==null?void 0:n.type)=="boolean"&&t.jsxs("div",{className:"flex items-center",children:[t.jsxs("p",{className:"text-md mr-1 font-bold text-gray-700",children:[(n==null?void 0:n.displayName)||"","?"]}),t.jsx(ht,{checked:((B=i==null?void 0:i.properties)==null?void 0:B[n==null?void 0:n.name])||!1,value:(E=i==null?void 0:i.properties)==null?void 0:E[n==null?void 0:n.name],onChange:K=>{p(`properties.${n==null?void 0:n.name}`,K.target.checked)},placeholder:`Chọn ${(n==null?void 0:n.displayName)||""}`})]})]})}))}),t.jsx(je,{name:"fullDescription",value:i==null?void 0:i.fullDescription,label:"Mô tả",placeholder:"Mô tả sản phẩm"})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("div",{}),t.jsxs("div",{className:"flex items-center",children:[t.jsx(X,{variant:"secondary",onClick:()=>r(),title:"Đóng"}),t.jsx(X,{type:"submit",title:"Xác nhận",variant:"primary",className:"ml-2",isLoading:s,onClick:m})]})]})]})}})},ve=()=>{const[e,a]=x.useState(!1),[r,s]=x.useState(!1),[w,C]=x.useState(!1),{accessToken:S,user:h}=ze(),j=Le(),[v,y]=x.useState([]),[R,N]=x.useState([]),{products:o,storeProducts:c}=_(p=>p.products),{currentStore:M}=_(p=>p.store),$=async p=>{var P,n,f,g,z;const{addLoadingEffect:d=!0,overrideCache:l=!1}=p||{};try{if(d&&a(!0),(o==null?void 0:o.length)==0||l){const B=await D.get(`${V}/products?&page=1&pageSize=1000`,{headers:{Authorization:`Bearer ${S}`}});(P=B==null?void 0:B.data)!=null&&P.success?(j(H((f=(n=B==null?void 0:B.data)==null?void 0:n.data)==null?void 0:f.results)),y((z=(g=B==null?void 0:B.data)==null?void 0:g.data)==null?void 0:z.results)):j(H([]))}}catch(B){console.log("GET PRODUCT RESPONSE",B)}finally{d&&a(!1)}},I=p=>{if((p==null?void 0:p.length)>0){const d=v.filter(l=>{if(l!=null&&l.name.toLowerCase().includes(p.toLowerCase()))return!0});j(H([...d]))}else j(H(v))},k=async(p,d)=>{var l,P,n,f;try{s(!0);const g=await D.post(`${V}/products/`,p,{headers:{Authorization:`Bearer ${S}`}});(l=g==null?void 0:g.data)!=null&&l.success?(s(!1),U.success("Thêm sản phẩm thành công"),d==null||d(),await $({overrideCache:!0,addLoadingEffect:!1})):(U.error(((P=g==null?void 0:g.data)==null?void 0:P.error)||"Thêm sản phẩm thất bại"),console.log("Error",(n=g==null?void 0:g.data)==null?void 0:n.data,(f=g==null?void 0:g.data)==null?void 0:f.error))}catch(g){s(!1),console.log("Client Error",g)}},u=async(p,d,l)=>{var P,n,f;try{s(!0);const g=await D.put(`${V}/products/${p}/`,d,{headers:{Authorization:`Bearer ${S}`}});(P=g==null?void 0:g.data)!=null&&P.success?(s(!1),U.success("Cập nhật sản phẩm thành công"),l==null||l(),await $({overrideCache:!0,addLoadingEffect:!1})):U.error(((n=g==null?void 0:g.data)==null?void 0:n.data)||((f=g==null?void 0:g.data)==null?void 0:f.error)||"Cập nhật sản phẩm thất bại")}catch(g){s(!1),console.log("Client Error",g)}},i=async p=>{var d,l,P;try{s(!0);const n=await D.delete(`${V}/products/${p}/`,{headers:{Authorization:`Bearer ${S}`}});(d=n==null?void 0:n.data)!=null&&d.success?(s(!1),await $({overrideCache:!0,addLoadingEffect:!1}),U.success("Xóa sản phẩm thành công")):U.error(((l=n==null?void 0:n.data)==null?void 0:l.data)||((P=n==null?void 0:n.data)==null?void 0:P.error)||"Xóa sản phẩm thất bại")}catch(n){s(!1),console.log("Client Error",n)}},m=async p=>{var P,n,f,g,z,B;const{addLoadingEffect:d=!0,overrideCache:l=!1}=p||{};try{if(d&&C(!0),(c==null?void 0:c.length)==0||l){const E=await D.get(`${V}/products/by-store?storeId=${(P=h==null?void 0:h.store)==null?void 0:P.id}&page=1&pageSize=1000`,{headers:{Authorization:`Bearer ${S}`}});(n=E==null?void 0:E.data)!=null&&n.success?(N((g=(f=E==null?void 0:E.data)==null?void 0:f.data)==null?void 0:g.results),j(ue((B=(z=E==null?void 0:E.data)==null?void 0:z.data)==null?void 0:B.results))):(N([]),j(ue([])))}}catch(E){console.log("GET PRODUCT RESPONSE",E)}finally{d&&C(!1)}};return{getAllProducts:$,createProduct:k,updateProduct:u,handleSearch:I,deleteProduct:i,getAllStoreProducts:m,updateStoreProduct:async(p,d,l,P)=>{var n,f,g;try{s(!0);const z=await D.put(`${V}/products/${M==null?void 0:M.id}/products/${p}`,d,{headers:{Authorization:`Bearer ${S}`}});(n=z==null?void 0:z.data)!=null&&n.success?(s(!1),U.success("Cập nhật sản phẩm thành công"),l==null||l(),await m({overrideCache:!0,addLoadingEffect:!1})):U.error(((f=z==null?void 0:z.data)==null?void 0:f.data)||((g=z==null?void 0:z.data)==null?void 0:g.error)||"Cập nhật sản phẩm thất bại")}catch(z){s(!1),l==null||l(),console.log("Client Error",z)}},products:o,loading:e,storeProductLoading:w,storeProducts:c,actionLoading:r}},mt=e=>{const[a,r]=x.useState(!1),[s,w]=x.useState([]),[C,S]=x.useState(""),[h,j]=x.useState(null),[v,y]=x.useState(!1),{getAllProducts:R,deleteProduct:N,actionLoading:o,handleSearch:c,products:M,loading:$,createProduct:I,updateProduct:k}=ve(),u=[{field:"actions",headerName:"Hành động",type:"string",width:100,renderCell:i=>{var b;const m=[{id:"delete",title:"Xóa sản phẩm",onPress:async()=>{var p,d;S((p=i.row)==null?void 0:p.id),await N((d=i.row)==null?void 0:d.id)},onActionSuccess:()=>R()},{id:"update",title:"Cập nhật sản phẩm",onPress:()=>{j(i.row),y(!0)},onActionSuccess:()=>R()}];return o&&C===((b=i.row)==null?void 0:b.id)?t.jsx(fe,{size:20}):t.jsx(xe,{options:m})}},{field:"id",headerName:"ID",width:70},{field:"upc",headerName:"Mã sản phẩm",width:200,renderCell:i=>t.jsx("p",{className:"text-sm font-semibold text-gray-800",children:i.value})},{field:"name",headerName:"Tên sản phẩm",width:250},{field:"category",headerName:"Danh mục",width:200,renderCell:i=>{var m;return t.jsx("p",{className:"text-sm font-semibold text-yellow-600",children:(m=i.value)==null?void 0:m.name})}},{field:"price",headerName:"Giá bán",width:200,renderCell:i=>{var m;return t.jsx("p",{className:"text-sm font-semibold text-green-800",children:(m=i.value)==null?void 0:m.displayPrice})}},{field:"createdAt",headerName:"Ngày tạo",width:150,renderCell:i=>t.jsx("p",{className:"font-semibold text-gray-600",children:i.value.prettyDate()})},{field:"updatedAt",headerName:"Ngày cập nhật",width:150,renderCell:i=>t.jsx("p",{className:"font-semibold text-gray-600",children:i.value.prettyDate()})}];return x.useEffect(()=>{R({addLoadingEffect:!0,overrideCache:!1})}),t.jsxs(t.Fragment,{children:[t.jsx(me,{title:"Quản lý sản phẩm ",content:t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"mb-6 flex w-full flex-row items-center justify-between gap-x-2 gap-y-2",children:[t.jsx("div",{className:"flex flex-col space-y-2",children:t.jsx(Ee,{name:"search-user",label:"Tìm kiếm sản phẩm",mode:"text",className:"max-w-[400px] rounded-xl border border-gray-300 px-4 py-2 text-sm",placeholder:"Trà sữa",autoComplete:"off",onChangeValue:i=>c(i)})}),t.jsxs("div",{className:"flex items-center gap-x-4",children:[t.jsx(X,{title:"Thêm sản phẩm",onClick:()=>{y(!0),j(null)}}),t.jsx(X,{title:"Xem theo cửa hàng",onClick:()=>{var i;(i=e.onChangeViewMode)==null||i.call(e,"store")}})]})]}),t.jsx("div",{className:"flex w-full flex-col gap-y-5 rounded-2xl bg-white shadow-xl",children:t.jsx("div",{className:"h-[750px] w-full shadow-lg",children:t.jsx(de,{sx:{borderRadius:"8px"},components:{LoadingOverlay:Ne},loading:$,rows:M,paginationMode:"client",pageSize:12,columns:u,disableSelectionOnClick:!0,onSelectionModelChange:i=>{r(!a),w(i)},selectionModel:s,checkboxSelection:!1})})})]})}),v?t.jsx(ie,{title:h?"Cập nhật sản phẩm":"Thêm sản phẩm",open:v,onClose:()=>y(!1),children:t.jsx(gt,{onClose:()=>y(!1),loading:o,currentProduct:h,onConfirm:async i=>{h?(S(h==null?void 0:h.id),await k(h==null?void 0:h.id,i,()=>y(!1))):await I({...i},()=>y(!1))}})}):null]})},ft=e=>{const{open:a,onClose:r,storeId:s,onImportSuccess:w}=e,[C,S]=T.useState([]);T.useState([]);const[h,j]=T.useState(!1),[v,y]=T.useState(1),[R,N]=T.useState(0),{accessToken:o}=_(u=>u.auth),[c,M]=T.useState([]),$=[{field:"id",headerName:"ID",width:70},{field:"upc",headerName:"Mã sản phẩm",width:200,renderCell:u=>t.jsx("div",{className:"text-sm font-semibold text-gray-800",children:u.value})},{field:"name",headerName:"Tên sản phẩm",width:250},{field:"category",headerName:"Danh mục",width:200,renderCell:u=>{var i;return t.jsx("div",{className:"text-sm font-semibold text-yellow-600",children:(i=u.value)==null?void 0:i.name})}},{field:"price",headerName:"Giá bán",width:200,renderCell:u=>{var i;return t.jsx("div",{className:"text-sm font-semibold text-green-800",children:(i=u.value)==null?void 0:i.displayPrice})}}],I=async()=>{var u,i,m,b,p;try{j(!0);const d=await D.get(`${V}/products?&page=${v}&pageSize=10`,{headers:{Authorization:`Bearer ${o}`}});if((u=d==null?void 0:d.data)!=null&&u.success){const l=(m=(i=d==null?void 0:d.data)==null?void 0:i.data)==null?void 0:m.results.filter(P=>!e.currentStoreProduct.find(n=>{var f;return((f=n==null?void 0:n.product)==null?void 0:f.upc)==P.upc}));S([...l]),N((p=(b=d==null?void 0:d.data)==null?void 0:b.data)==null?void 0:p.totalPage)}else j(!1),S([])}catch{}finally{j(!1)}},k=async()=>{var u,i,m;try{const b=await D.post(`${V}/products/link-to-store`,{productIds:c.map(p=>p.id),storeId:s},{headers:{Authorization:`Bearer ${o}`}});(u=b==null?void 0:b.data)!=null&&u.success?(r(),w()):(U.error(((i=b==null?void 0:b.data)==null?void 0:i.data)||((m=b==null?void 0:b.data)==null?void 0:m.error)||"Có lỗi xảy ra khi thêm sản phẩm vào cửa hàng"),r())}catch(b){U.error("Có lỗi xảy ra khi thêm sản phẩm vào cửa hàng"),console.log("IMPORT PRODUCT ERROR",b),r()}};return x.useEffect(()=>{I()},[v]),t.jsx(t.Fragment,{children:a?t.jsxs("div",{className:"h-[900px] py-4",children:[t.jsx("div",{className:"mb-6 flex w-full flex-row-reverse gap-x-2 gap-y-2",children:t.jsx("button",{onClick:()=>k(),className:"flex h-[40px] w-fit items-center rounded-lg bg-gray-500 px-3 py-1 font-bold text-white hover:opacity-80",children:t.jsx("p",{children:"Thêm vào cửa hàng"})})}),t.jsx(de,{loading:h,rows:C,paginationMode:"server",page:v,sx:{height:"700px"},rowCount:R,pageSize:10,columns:$,onSelectionModelChange:u=>{let i=u.map(m=>C.find(b=>b.id===m));M([...i])},hideFooterPagination:!0,checkboxSelection:!0}),t.jsx("div",{className:"mt-4 flex flex-row-reverse gap-x-2",children:t.jsx(et,{onChange:(u,i)=>y(i),count:R,defaultPage:1,page:v})})]}):null})},xt=e=>{const{currentProduct:a,onClose:r,loading:s,onConfirm:w}=e,[C,S]=T.useState(a||null),[h,j]=T.useState(""),[v,y]=T.useState([]),R=Q().shape({inventory:oe().required("Vui lòng nhập số lượng sản phẩm"),product:Q().shape({name:q().required("Vui lòng điền tên sản phẩm"),upc:q().required("Vui lòng nhập mã sản phẩm"),price:Q().shape({price:oe().required("Vui lòng nhập giá sản phẩm"),displayPrice:q().required("Vui lòng nhập giá sản phẩm")})})}),N=async o=>{var c,M,$,I,k,u,i,m,b,p,d,l;w({...o,inventory:Number(o==null?void 0:o.inventory),price:{...o==null?void 0:o.price,displayPrice:((c=o==null?void 0:o.price)==null?void 0:c.displayPrice)||(($=(M=o==null?void 0:o.product)==null?void 0:M.price)==null?void 0:$.displayPrice),displaySalePrice:((I=o==null?void 0:o.price)==null?void 0:I.displaySalePrice)||((u=(k=o==null?void 0:o.product)==null?void 0:k.price)==null?void 0:u.displaySalePrice),price:Number((i=o==null?void 0:o.price)==null?void 0:i.price)||Number((b=(m=o==null?void 0:o.product)==null?void 0:m.price)==null?void 0:b.price),salePrice:Number(((p=o==null?void 0:o.price)==null?void 0:p.salePrice)||Number((l=(d=o==null?void 0:o.product)==null?void 0:d.price)==null?void 0:l.salePrice))}})};return x.useEffect(()=>{var o,c;a&&(j(((o=a==null?void 0:a.product)==null?void 0:o.thumbnail)||""),y(((c=a==null?void 0:a.product)==null?void 0:c.images)||[]))},[a]),t.jsx(be,{initialValues:C||{},validationSchema:R,onSubmit:N,enableReinitialize:!0,children:({submitForm:o,values:c,handleSubmit:M,setValues:$,setFieldValue:I})=>{var k,u,i,m,b,p,d;return t.jsxs("div",{className:"flex flex-col space-y-10",children:[t.jsxs("div",{className:"flex flex-col space-y-5",children:[t.jsxs("div",{className:"grid grid-cols-1 items-center justify-between gap-x-2 gap-y-5 tablet:grid-cols-2",children:[t.jsx(O,{type:"text",disabled:!0,name:"product.name",value:(k=c==null?void 0:c.product)==null?void 0:k.name,label:"Tên sản phẩm",placeholder:"Nhập tên sản phẩm"}),t.jsx(O,{type:"text",disabled:!0,name:"product.upc",value:(u=c==null?void 0:c.product)==null?void 0:u.upc,label:"Mã sản phẩm",placeholder:"Nhập mã sản phẩm"})]}),t.jsxs("div",{className:"grid grid-cols-1 items-center justify-between gap-x-2 gap-y-5 tablet:grid-cols-2",children:[t.jsx(O,{type:"number",mode:"text",name:"price.price",value:(i=c==null?void 0:c.price)==null?void 0:i.price,label:"Giá sản phẩm",placeholder:"Nhập giá sản phẩm"}),t.jsx(O,{type:"text",name:"price.displayPrice",value:(m=c==null?void 0:c.price)==null?void 0:m.displayPrice,label:"Giá hiển thị sản phẩm",placeholder:"Nhập giá hiển thị sản phẩm"}),t.jsx(O,{type:"number",mode:"text",name:"price.salePrice",value:(b=c==null?void 0:c.price)==null?void 0:b.salePrice,label:"Giá sale sản phẩm",placeholder:"Nhập giá sale sản phẩm"}),t.jsx(O,{type:"text",name:"price.displaySalePrice",value:(p=c==null?void 0:c.price)==null?void 0:p.displaySalePrice,label:"Giá sale hiển thị sản phẩm",placeholder:"Nhập giá sale hiển thị sản phẩm"})]}),t.jsx("div",{children:t.jsx(O,{type:"number",name:"inventory",value:c==null?void 0:c.inventory,label:"Số lượng hiện có",placeholder:"Nhập số lượng hiện có"})}),t.jsx(Ce,{thumbnailUploaded:h,setThumbnailUploaded:l=>j(l)}),t.jsx(Se,{thumbnailUploaded:v,setThumbnailUploaded:l=>y(l)}),t.jsx(je,{name:"product.fullDescription",disabled:!0,value:(d=c==null?void 0:c.product)==null?void 0:d.fullDescription,label:"Mô tả",placeholder:"Mô tả sản phẩm"})]}),t.jsx("div",{className:"flex flex-row-reverse items-center justify-between",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx(X,{variant:"secondary",onClick:()=>r(),title:"Đóng"}),t.jsx(X,{type:"submit",title:"Xác nhận",variant:"primary",className:"ml-2",isLoading:e==null?void 0:e.loading,onClick:M})]})})]})}})},bt=e=>{const[a,r]=x.useState(!1),[s,w]=x.useState([]),{user:C,accessToken:S}=_(n=>n.auth),[h,j]=x.useState(!1),[v,y]=x.useState(""),[R,N]=x.useState(null),[o,c]=x.useState(!1),[M,$]=x.useState(!1),{getAllStores:I,listStore:k,loading:u,currentStore:i,dispatchSetCurrentStore:m}=Te(),{getAllStoreProducts:b,storeProducts:p,storeProductLoading:d,updateStoreProduct:l}=ve(),P=[{field:"id",headerName:"ID",width:70},{field:"product.upc",headerName:"Mã sản phẩm",width:200,renderCell:n=>{var f;return t.jsx("div",{className:"text-sm font-bold text-gray-600",children:(f=n.row.product)==null?void 0:f.upc})}},{field:"product.name",headerName:"Tên sản phẩm",width:250,renderCell:n=>{var f;return t.jsx("div",{className:"",children:(f=n.row.product)==null?void 0:f.name})}},{field:"inventory",headerName:"Còn trong kho",width:150},{field:"price",headerName:"Giá bán",width:200,renderCell:n=>{var f;return t.jsx("div",{className:"text-sm font-semibold text-green-800",children:(f=n.value)==null?void 0:f.displayPrice})}},{field:"product.reatedAt",headerName:"Ngày tạo",width:150,renderCell:n=>{var f;return t.jsx("div",{className:"",children:((f=n.row.product)==null?void 0:f.createdAt).prettyDate()})}},{field:"product.updatedAt",headerName:"Ngày cập nhật",width:150,renderCell:n=>{var f;return t.jsx("div",{className:"",children:((f=n.row.product)==null?void 0:f.updatedAt).prettyDate()})}},{field:"actions",headerName:"Hành động",type:"string",width:300,headerAlign:"left",align:"left",renderCell:n=>{var g;const f=[{id:"update",title:"Cập nhật sản phẩm",onPress:()=>{N(n.row),$(!0)},onActionSuccess:()=>b({overrideCache:!0,addLoadingEffect:!1})}];return h&&v===((g=n.row)==null?void 0:g.id)?t.jsx(fe,{size:20}):t.jsx(xe,{options:f})}}];return x.useEffect(()=>{i&&b({overrideCache:!1,addLoadingEffect:!0})},[i]),x.useEffect(()=>{I({showLoading:!0,overrideCache:!1})},[]),console.log("listStore",k),t.jsxs(t.Fragment,{children:[t.jsx(me,{title:"Quản lý sản phẩm ",content:t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"mb-6 flex w-full items-center justify-between gap-y-2",children:[t.jsx("div",{className:"flex items-center",children:t.jsx(ye,{optionSelected:i,options:k,name:"currentStore",keyLabel:"name",label:C.role==="admin"?"Chọn cửa hàng":"Cửa hàng",onSelect:n=>{n.id==="all"?e.onChangeViewMode("tenant"):m(n)},placeholder:C.role==="admin"?"Chọn cửa hàng":"Cửa hàng"})}),t.jsxs("button",{onClick:()=>{c(!0),N(null)},className:"flex h-[40px] w-fit items-center rounded-lg bg-gray-500 px-3 py-1 font-bold text-white hover:opacity-80",children:[t.jsx(Ae,{className:"h-[20px] w-[20px] font-bold text-white"}),t.jsx("p",{children:"Nhập sản phẩm"})]})]}),t.jsx("div",{className:"flex w-full flex-col gap-y-5 rounded-2xl bg-white",children:t.jsx("div",{className:"h-[700px] w-full",children:t.jsx(de,{sx:{borderRadius:"8px"},loading:u||d,components:{LoadingOverlay:Ne},rows:p,paginationMode:"client",pageSize:10,columns:P,disableSelectionOnClick:!0,onSelectionModelChange:n=>{r(!a),w(n)},selectionModel:s,checkboxSelection:!1})})})]})}),o?t.jsx(ie,{title:"Nhập sản phẩm",maxWidth:"lg",open:o,onClose:()=>c(!1),children:t.jsx(ft,{onImportSuccess:()=>b({overrideCache:!0,addLoadingEffect:!1}),storeId:i==null?void 0:i.id,currentStoreProduct:p,open:o,onClose:()=>c(!1)})}):null,M&&t.jsx(ie,{title:`Chỉnh sửa sản phẩm tại cửa hàng ${i==null?void 0:i.name}`,maxWidth:"md",open:M,onClose:()=>$(!1),children:t.jsx(xt,{onClose:()=>c(!1),loading:h,currentProduct:R,onConfirm:async n=>{var f;R&&await l((f=R==null?void 0:R.product)==null?void 0:f.upc,n)}})})]})},It=()=>{const{user:e}=_(s=>s.auth),[a,r]=x.useState((e==null?void 0:e.role)==="admin"?"tenant":"store");return t.jsx(t.Fragment,{children:a==="store"?t.jsx(bt,{onChangeViewMode:s=>r(s)}):t.jsx(mt,{onChangeViewMode:s=>r(s)})})};export{It as default};
