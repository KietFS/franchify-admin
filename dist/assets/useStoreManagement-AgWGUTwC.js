import{u as A,b as D,w as O,x as k,ah as f,t as l,v as d,ai as R}from"./index-Bpu-ZP8V.js";const z=()=>{const{listStore:p,currentStore:E}=A(t=>t.store),[y,i]=D.useState(!1),{accessToken:w,user:u}=O(),n=k();return{currentStore:E,getAllStores:async t=>{var r,c,a,h,m,g,T,S;const{overrideCache:o=!1,showLoading:s=!1}=t||{};try{if(p.length===0||o){s&&i(!0);const e=await l.get(`${d}/store?pageSize=30`,{headers:{Authorization:`Bearer ${w}`}});(r=e==null?void 0:e.data)!=null&&r.success?(s&&i(!1),u.role=="admin"?n(R([...(a=(c=e==null?void 0:e.data)==null?void 0:c.data)==null?void 0:a.results,{id:"all",name:"Tất cả cửa hàng"}])):(n(R((m=(h=e==null?void 0:e.data)==null?void 0:h.data)==null?void 0:m.results)),i(!1)),n(f((S=(T=(g=e==null?void 0:e.data)==null?void 0:g.data)==null?void 0:T.results)==null?void 0:S.find(C=>C.id==u.store.id)))):s&&i(!1)}}catch(e){o&&i(!1),console.log("GET STORE ERROR",e)}},createStore:async(t,o)=>{var s;try{const r=await l.post(`${d}/store`,{name:t.name,supportPickup:t.supportPickup,supportDelivery:t.supportDelivery,openTime:t.openTime,closeTime:t.closeTime,storeCode:Number(t.storeCode),lat:t.lat,lng:t.lng});if((s=r==null?void 0:r.data)!=null&&s.success)return o&&o(),r;console.log("error when creating store")}catch(r){console.log("CREATE STORE ERROR",r)}},updateStore:async(t,o,s)=>{var r,c;try{const a=await l.patch(`${d}/store/${t==null?void 0:t.id}`,{name:o.name,supportPickup:o.supportPickup,supportDelivery:o.supportDelivery,openTime:o.openTime,closeTime:o.closeTime,storeCode:Number(o.storeCode)});if((r=a==null?void 0:a.data)!=null&&r.success)return s&&s(),a;throw new Error(((c=a==null?void 0:a.data)==null?void 0:c.error)||"Error when updating store")}catch(a){console.log("UPDATE STORE ERROR",a)}},loading:y,listStore:p,dispatchSetCurrentStore:t=>{n(f(t))}}};export{z as u};
